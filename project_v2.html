<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>ì‚´ì•„ì˜¨ ì‹œê°„ & ë‚¨ì€ ì˜ˆìƒ ìˆ˜ëª… íƒ€ì´ë¨¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#0b0b0f; color:#eaeaea; }
    .wrap { max-width: 880px; margin: 40px auto; padding: 16px; }
    .card { background:#141419; border:1px solid #2a2a33; border-radius:12px; padding:16px 18px; margin-top:16px; }
    .row { display:grid; grid-template-columns: 140px 1fr; gap:12px; align-items:center; margin-bottom:12px; }
    input[type="date"]{ background:#0f0f14; color:#eaeaea; border:1px solid #2a2a33; border-radius:8px; padding:10px 12px; }
    .title { font-size: 26px; font-weight: 800; margin-bottom:6px; }
    .stat-main { font-size: 24px; font-weight: 800; letter-spacing: .2px; margin-top:8px; }
    .sub  { color:#9ca3af; font-size: 12px; margin-top: 6px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap:12px; margin-top:12px; }
    .pill { background:#0f0f14; border:1px solid #2a2a33; border-radius:10px; padding:12px; }
    .label { color:#9ca3af; font-size:12px; }
    .value { font-weight: 700; font-size: 20px; margin-top:4px; }
    .danger { color:#f97373; }
    .ok { color:#4ade80; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ì¸ìƒ íƒ€ì´ë¨¸ (ëŒ€í•œë¯¼êµ­ í‰ê·  ê¸°ëŒ€ìˆ˜ëª… ê¸°ë°˜)</h1>
    <p class="sub">
      í†µê³„ì²­ 2023ë…„ ê°„ì´ìƒëª…í‘œ(5ì„¸ë³„, ì „ì²´ ì¸êµ¬ ê¸°ì¤€)ì˜ <b>ì—°ë ¹ë³„ ê¸°ëŒ€ì—¬ëª…</b>ì„ ì´ìš©í•´
      <b>ì‚´ì•„ì˜¨ ì‹œê°„</b>ê³¼ <b>ë‚¨ì€ ì˜ˆìƒ ìˆ˜ëª…</b>ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ê°œì¸ì˜ ì‹¤ì œ ìˆ˜ëª…ì„ ì˜ˆì¸¡í•˜ëŠ” ë„êµ¬ëŠ” ì•„ë‹™ë‹ˆë‹¤.
    </p>

    <!-- ìƒë…„ì›”ì¼ ì…ë ¥ -->
    <div class="card">
      <div class="row">
        <label for="birth">ìƒë…„ì›”ì¼</label>
        <input id="birth" type="date" value="2003-01-01" />
      </div>
      <p class="sub">
        ìƒë…„ì›”ì¼ì„ ê³ ì¹˜ë©´ ë‘ íƒ€ì´ë¨¸ê°€ ë‹¤ì‹œ ê³„ì‚°ë©ë‹ˆë‹¤. <br>
        ê¸°ëŒ€ì—¬ëª… ë°ì´í„°ëŠ” 5ì„¸ êµ¬ê°„(0, 1, 5, 10, â€¦, 100+) ê¸°ì¤€ì´ë©°, ì¤‘ê°„ ë‚˜ì´ëŠ” ì„ í˜• ë³´ê°„ìœ¼ë¡œ ê·¼ì‚¬í•©ë‹ˆë‹¤.
      </p>
    </div>

    <!-- ì‚´ì•„ì˜¨ ì‹œê°„ -->
    <div class="card">
      <div class="title">ì§€ê¸ˆê¹Œì§€ ì‚´ì•„ì˜¨ ì‹œê°„</div>
      <div id="lived-main" class="stat-main">ê³„ì‚° ì¤‘â€¦</div>
      <div class="sub">(ì¼ + ì‹œ:ë¶„:ì´ˆ, ì—°ë„ëŠ” í‰ê·  íƒœì–‘ë…„ ê¸°ì¤€ ê·¼ì‚¬)</div>

      <div class="grid">
        <div class="pill">
          <div class="label">ì´ ì¼ìˆ˜</div>
          <div class="value" id="lived-days">-</div>
        </div>
        <div class="pill">
          <div class="label">ì´ ì‹œê°„</div>
          <div class="value" id="lived-hours">-</div>
        </div>
        <div class="pill">
          <div class="label">ì´ ë¶„</div>
          <div class="value" id="lived-mins">-</div>
        </div>
        <div class="pill">
          <div class="label">ì´ ì´ˆ</div>
          <div class="value" id="lived-secs">-</div>
        </div>
        <div class="pill">
          <div class="label">ëŒ€ëµ ëª‡ ë…„?</div>
          <div class="value" id="lived-years">- ë…„</div>
        </div>
      </div>
    </div>

    <!-- ë‚¨ì€ ì˜ˆìƒ ìˆ˜ëª… -->
    <div class="card">
      <div class="title">ë‚¨ì€ ì˜ˆìƒ ìˆ˜ëª… (í†µê³„ ê¸°ì¤€)</div>
      <div id="remain-main" class="stat-main">ê³„ì‚° ì¤‘â€¦</div>
      <div class="sub">
        í†µê³„ì²­ 2023ë…„ ìƒëª…í‘œì—ì„œ, í˜„ì¬ ë‚˜ì´ì— í•´ë‹¹í•˜ëŠ” <b>ê¸°ëŒ€ì—¬ëª…(ì „ì²´)</b> ê°’ì„ ì‚¬ìš©í•´
        â€œì§€ê¸ˆ ì´ ì‹œì ì—ì„œ ë‚¨ì€ í‰ê·  ìˆ˜ëª…â€ì„ ê·¼ì‚¬í•œ ê°’ì…ë‹ˆë‹¤.
      </div>

      <div class="grid">
        <div class="pill">
          <div class="label">ë‚¨ì€ ì—°ìˆ˜ (ê¸°ëŒ€ì—¬ëª…)</div>
          <div class="value" id="remain-years">- ë…„</div>
        </div>
        <div class="pill">
          <div class="label">ë‚¨ì€ ì¼ìˆ˜ (ê·¼ì‚¬)</div>
          <div class="value" id="remain-days">- ì¼</div>
        </div>
        <div class="pill">
          <div class="label">ë‚¨ì€ ì‹œê°„ (ê·¼ì‚¬)</div>
          <div class="value" id="remain-hours">- ì‹œê°„</div>
        </div>
        <div class="pill">
          <div class="label">ì˜ˆìƒ ìˆ˜ëª… ë„ë‹¬ ì‹œì  (ëŒ€ëµ)</div>
          <div class="value" id="expected-death-date">-</div>
        </div>
      </div>

      <p class="sub danger">
        â€» ì´ ê°’ì€ â€œëŒ€í•œë¯¼êµ­ ì¸êµ¬ ì „ì²´ì˜ í‰ê·  íŒ¨í„´â€ì„ ë‹¨ìˆœíˆ ì ìš©í•œ ê²ƒì´ë©°,
        ê°œì¸ì˜ ì‹¤ì œ ê±´ê°•ì´ë‚˜ ìƒí™œìŠµê´€, ì‚¬ê³ , ì§ˆë³‘ ë“±ì„ ë°˜ì˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </p>
    </div>
  </div>

  <script>
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 1. ê¸°ë³¸ ìƒìˆ˜ & DOM ìš”ì†Œ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const MS_PER_YEAR = 365.2425 * 24 * 60 * 60 * 1000;

    const birthInput = document.getElementById('birth');

    // ì‚´ì•„ì˜¨ ì‹œê°„ ì¶œë ¥ ìš”ì†Œ
    const livedMain  = document.getElementById('lived-main');
    const livedDays  = document.getElementById('lived-days');
    const livedHours = document.getElementById('lived-hours');
    const livedMins  = document.getElementById('lived-mins');
    const livedSecs  = document.getElementById('lived-secs');
    const livedYears = document.getElementById('lived-years');

    // ë‚¨ì€ ì‹œê°„ ì¶œë ¥ ìš”ì†Œ
    const remainMain   = document.getElementById('remain-main');
    const remainYears  = document.getElementById('remain-years');
    const remainDays   = document.getElementById('remain-days');
    const remainHours  = document.getElementById('remain-hours');
    const expDeathDate = document.getElementById('expected-death-date');

    let timerId = null;
    let expectedDeathTime = null; // Date ê°ì²´

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 2. 2023 ê°„ì´ìƒëª…í‘œ(5ì„¸ë³„, ì „ì²´ ê¸°ëŒ€ì—¬ëª…) ë°ì´í„°
    //    ì—…ë¡œë“œí•œ íŒŒì¼ì—ì„œ "ì—°ë ¹ë³„ ê¸°ëŒ€ì—¬ëª…(ì „ì²´)"ë§Œ ë½‘ì€ ê²ƒ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const lifeTable = [
      { age: 0,   ex: 83.5 },
      { age: 1,   ex: 82.7 },
      { age: 5,   ex: 78.7 },
      { age: 10,  ex: 73.8 },
      { age: 15,  ex: 68.8 },
      { age: 20,  ex: 63.9 },
      { age: 25,  ex: 59.0 },
      { age: 30,  ex: 54.1 },
      { age: 35,  ex: 49.3 },
      { age: 40,  ex: 44.4 },
      { age: 45,  ex: 39.7 },
      { age: 50,  ex: 35.0 },
      { age: 55,  ex: 30.4 },
      { age: 60,  ex: 25.9 },
      { age: 65,  ex: 21.5 },
      { age: 70,  ex: 17.2 },
      { age: 75,  ex: 13.2 },
      { age: 80,  ex: 9.7 },
      { age: 85,  ex: 6.8 },
      { age: 90,  ex: 4.7 },
      { age: 95,  ex: 3.2 },
      { age: 100, ex: 2.2 }, // "100+"ë¥¼ 100ìœ¼ë¡œ ì²˜ë¦¬
    ];

    // ì£¼ì–´ì§„ ë‚˜ì´(ì‹¤ìˆ˜, ì˜ˆ: 22.4ì„¸)ì— ëŒ€í•´
    // lifeTableì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì  ì‚¬ì´ë¥¼ ì„ í˜• ë³´ê°„í•´ì„œ ê¸°ëŒ€ì—¬ëª…(ë‚¨ì€ ì—°ìˆ˜)ì„ ê·¼ì‚¬
    function lookupRemainingYears(ageYears) {
      const n = lifeTable.length;
      if (ageYears <= lifeTable[0].age) return lifeTable[0].ex;
      if (ageYears >= lifeTable[n - 1].age) return lifeTable[n - 1].ex;

      for (let i = 0; i < n - 1; i++) {
        const a0 = lifeTable[i];
        const a1 = lifeTable[i + 1];
        if (ageYears >= a0.age && ageYears < a1.age) {
          const t = (ageYears - a0.age) / (a1.age - a0.age); // 0~1
          return a0.ex + (a1.ex - a0.ex) * t;
        }
      }
      return lifeTable[n - 1].ex;
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 3. ë©”ì¸ íƒ€ì´ë¨¸ ë¡œì§
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function startTimer() {
      if (timerId) clearInterval(timerId);

      const birthStr = birthInput.value;
      if (!birthStr) {
        livedMain.textContent  = 'ìƒë…„ì›”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.';
        remainMain.textContent = 'ìƒë…„ì›”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.';
        return;
      }

      const birthDate = new Date(birthStr + 'T00:00:00');
      const now       = new Date();

      // ì‚´ì•„ì˜¨ ë‚˜ì´(ì—° ë‹¨ìœ„, ì‹¤ìˆ˜)
      const ageMs    = Math.max(0, now.getTime() - birthDate.getTime());
      const ageYears = ageMs / MS_PER_YEAR;

      // í˜„ì¬ ë‚˜ì´ì— ëŒ€í•œ ê¸°ëŒ€ì—¬ëª…(ë‚¨ì€ ì—°ìˆ˜) ê·¼ì‚¬
      const ex = lookupRemainingYears(ageYears); // ë‚¨ì€ ì—°ìˆ˜

      // "ì§€ê¸ˆ ì‹œì "ì„ ê¸°ì¤€ìœ¼ë¡œ exë…„ ë’¤ë¥¼ ê¸°ëŒ€ìˆ˜ëª… ë„ë‹¬ ì‹œì ìœ¼ë¡œ ë³¸ë‹¤
      expectedDeathTime = new Date(now.getTime() + ex * MS_PER_YEAR);

      // ë°”ë¡œ í•œ ë²ˆ ê°±ì‹ í•˜ê³ , 1ì´ˆë§ˆë‹¤ ê°±ì‹ 
      tick();
      timerId = setInterval(tick, 1000);
    }

    function tick() {
      const birthStr = birthInput.value;
      if (!birthStr) return;

      const birthDate = new Date(birthStr + 'T00:00:00');
      const now       = new Date();

      // 1) ì‚´ì•„ì˜¨ ì‹œê°„ ê³„ì‚°
      const livedMs = Math.max(0, now.getTime() - birthDate.getTime());
      updateLivedView(livedMs);

      // 2) ë‚¨ì€ ì˜ˆìƒ ìˆ˜ëª… ê³„ì‚° (expectedDeathTime ê¸°ì¤€ ì¹´ìš´íŠ¸ë‹¤ìš´)
      if (!expectedDeathTime) return;
      const remainMs = Math.max(0, expectedDeathTime.getTime() - now.getTime());
      updateRemainView(remainMs, birthDate, now);
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 4. í™”ë©´ ê°±ì‹  í•¨ìˆ˜ë“¤
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function updateLivedView(ms) {
      const totalSeconds = Math.floor(ms / 1000);
      const s            = totalSeconds % 60;
      const totalMinutes = Math.floor(totalSeconds / 60);
      const m            = totalMinutes % 60;
      const totalHours   = Math.floor(totalMinutes / 60);
      const h            = totalHours % 24;
      const d            = Math.floor(totalHours / 24);

      const approxYears  = (ms / MS_PER_YEAR).toFixed(6);
      const totalMins    = Math.floor(ms / (1000 * 60));
      const totalHrs     = Math.floor(ms / (1000 * 60 * 60));
      const totalDays    = Math.floor(ms / (1000 * 60 * 60 * 24));

      livedMain.textContent = `${formatNumber(d)}ì¼  ${pad(h)}:${pad(m)}:${pad(s)}`;
      livedDays.textContent  = formatNumber(totalDays);
      livedHours.textContent = formatNumber(totalHrs);
      livedMins.textContent  = formatNumber(totalMins);
      livedSecs.textContent  = formatNumber(totalSeconds);
      livedYears.textContent = `${approxYears} ë…„`;
    }

    function updateRemainView(msLeft, birthDate, now) {
      const yearsLeft = msLeft / MS_PER_YEAR;
      const daysLeft  = msLeft / (1000 * 60 * 60 * 24);
      const hoursLeft = msLeft / (1000 * 60 * 60);

      const totalSeconds = Math.floor(msLeft / 1000);
      const s            = totalSeconds % 60;
      const totalMinutes = Math.floor(totalSeconds / 60);
      const m            = totalMinutes % 60;
      const totalHours   = Math.floor(totalMinutes / 60);
      const h            = totalHours % 24;
      const d            = Math.floor(totalHours / 24);

      remainMain.textContent = `${formatNumber(d)}ì¼  ${pad(h)}:${pad(m)}:${pad(s)} ë‚¨ìŒ (ê·¼ì‚¬)`;
      remainYears.textContent = `${yearsLeft.toFixed(3)} ë…„`;
      remainDays.textContent  = `${Math.floor(daysLeft).toLocaleString('ko-KR')} ì¼`;
      remainHours.textContent = `${Math.floor(hoursLeft).toLocaleString('ko-KR')} ì‹œê°„`;

      // ì˜ˆìƒ ì‚¬ë§ ì‹œì (ëŒ€ëµ)
      if (msLeft <= 0) {
        expDeathDate.textContent = 'í†µê³„ìƒ ê¸°ëŒ€ìˆ˜ëª…ì„ ì´ë¯¸ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤ (ì¶•í•˜í•©ë‹ˆë‹¤ ğŸ‰)';
      } else {
        const expected = expectedDeathTime;
        const y = expected.getFullYear();
        const mon = expected.getMonth() + 1;
        const d2 = expected.getDate();
        expDeathDate.textContent = `${y}ë…„ ${mon}ì›” ${d2}ì¼ ì¦ˆìŒ`;
      }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 5. ìœ í‹¸ í•¨ìˆ˜
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function pad(n){ return String(n).padStart(2,'0'); }
    function formatNumber(n){ return n.toLocaleString('ko-KR'); }

    // ì…ë ¥ì´ ë°”ë€” ë•Œë§ˆë‹¤ ì¬ê³„ì‚°
    birthInput.addEventListener('change', startTimer);

    // ì²« ì‹œì‘
    startTimer();
  </script>
</body>
</html>
